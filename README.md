# 简介

缠论２可视化交易插件

# 风险警示

[原软件](https://github.com/neuks/Indicator)仅旨在实现最贴近缠师原文所的线段、中枢概念的可视化结果，软件免费分享使用，没有任何限制。
本软件在思考缠论内容后应用了一些新概念，增加了新接口以实现这些新思想。

市场有风险，使用者自行承担任何由本软件而导致的买卖交易后果，作者本人不承担因为使用本软件而导致的任何直接或间接后果。

# 安装方法

目前仅支持通达信软件使用。安装时，首先将CZSC2.dll复制到通达信安装目录下的T0002\dlls目录之中，并在通达信公式管理器中将本dll加载到1号dll插件之中。

# 通达信端代码

```text
{参数RATE：单边交易费率百分数}
DLL:=TDXDLL1(11,H,L,RATE); {K线交易使用11号接口替换原来的1号接口}
HIB:=TDXDLL1(2,DLL,H,L); {中枢高点}
LOB:=TDXDLL1(3,DLL,H,L); {中枢低点}
SIG:=TDXDLL1(4,DLL,H,L); {中枢起终点}
BSP:=TDXDLL1(5,DLL,L,H); {二三类买卖点}
SLP:=TDXDLL1(8,DLL,L,H); {线段斜率}
MA20:MA(CLOSE,20), COLORMAGENTA;
MA10:MA(CLOSE,10), COLORYELLOW;
MA5:MA(CLOSE,5), COLORWHITE;
DRAWLINE(DLL=-1,L,DLL=+1,H,0), COLORRED;
DRAWLINE(DLL=+1,H,DLL=-1,L,0), COLORGREEN;
IF(HIB,HIB,DRAWNULL), COLORLIRED;
IF(LOB,LOB,DRAWNULL), COLORLIMAGENTA;
DRAWNUMBER(DLL=+1,H,SLP), COLORRED, DRAWABOVE;
DRAWNUMBER(DLL=-1,L,SLP), COLORGREEN;
BUY(BSP=3,LOW);
SELL(BSP=12,HIGH);
BUYSHORT(BSP=2,LOW);
SELLSHORT(BSP=13,HIGH);
```

# Ｋ线交易——关于缠论中一些概念的思考

交易撮合系统输出的逐笔成交数据（成交价格、成交股数等）是离散的，在时间上有先后顺序。将逐笔成交的（成交时间，成交价格）记录在以时间为X轴、价格为Y轴的坐标系上，我称之为零Ｋ图或ＯＫ图，意为时间周期无穷小的Ｋ线图。

以ＯＫ图上任意两点的价格进行一次来回交易（买卖份额一样），交易结果可以分为两类：有利的（利润大于０）和无利的（利润小等于０）。

ＯＫ图上的交易，价格上只有一个点，时间上也只有一个点。为了在价格和时间上增加弹性，需要把临近的成交点分别合并为买入点集合与卖出点集合。Ｋ线图可以有不同的时间级别，Ｋ线天然具备价格集合的特点和时间与价格上的弹性。

把ＯＫ图替换为Ｋ线图，从两根Ｋ线的价格区间任意各取一个价格进行一次来回交易，交易结果可以分为三类：有利的、无利的和不确定的（如果两根Ｋ线的价格区间有重叠）。

定义“Ｋ线交易”为：在每根Ｋ线上最多只买入一次或卖出一次，买入时以一根Ｋ线的最高价买入，卖出时以另一根Ｋ线的最低价卖出，买卖份额相同。可以在Ｋ线图中通过选择合适的Ｋ线组合（买卖点）使Ｋ线交易获利最大化。相邻买卖点的连线定义为Ｋ线交易的“笔”。

Ｋ线交易获利最大化时，买点总是Ｋ线最高价Ｈ的局部极小值，卖点总是Ｋ线最低价Ｌ的局部极大值。反过来，Ｋ线最高价Ｈ的局部极小值的形态称为Ｋ线交易的“底分型”，Ｋ线最低价Ｌ的局部极大值的形态称为为Ｋ线交易的“顶分型”。注意，组成中间短两边长的“川”字形的三条连续Ｋ线，对于Ｋ线交易既是“底分型”也是“顶分型”。

Ｋ线交易获利最大化有以下明确的意义：从卖点Ｋ线到相邻的下一个买点Ｋ线之间任意选择两条进行Ｋ线交易，绝不会出现有利的交易结果。也就是说，如果交易模式类似Ｋ线交易（例如：突破上一根Ｋ线高点时买入，跌破上一根Ｋ线低点时卖出），那么就应该避开这样的区间。

由Ｋ线交易导出的相关定义，虽然与缠论中的定义不一致，但是避免了缠论Ｋ线包含处理的麻烦和歧义，也避免了千人千缠的问题，其定义标准面向交易结果，完全量化且有意义。

Ｋ线交易的交易结果中会出现盈亏不确定的情况，这是由于该Ｋ线图的周期级别较大导致。也就是说，盈亏不确定性不是本级别Ｋ线图该解决的问题，对于特定区间需要通过更小的Ｋ线周期甚至ＯＫ图来去除不确定性。

本软件11号接口采用Ｋ线交易的相关定义替代缠论中的对应概念。
虽然Ｋ线交易是在最高价买入最低价卖出，但是为了使笔的连线醒目及使用习惯问题，在笔的连线上仍采用高点高价、低点低价的方式来显示。
